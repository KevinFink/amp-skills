#!/usr/bin/env bash
set -euo pipefail

if [[ $# -lt 2 ]]; then
  echo "Usage: bd-commit <commit_message_file> <file>..." >&2
  exit 1
fi

commit_message_file="$1"
shift

if [[ ! -f "$commit_message_file" ]]; then
  echo "Commit message file not found: $commit_message_file" >&2
  exit 1
fi

git add "$@" .beads/
git commit -F "$commit_message_file"
rm "$commit_message_file"
